"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[82923],{82923:function(a,b,c){c.r(b),c.d(b,{default:function(){return z}});var d=c(89703),e=c(44678),f=c(67952),g=c(28495),h=c(51425),i=c(48282),j=c(80049),k=c(20318),l=c(76116),m=c(32388),n=c(41660),o=c(52774),p=c(33944),q=c(23527),r=c(60297),s=c(20888),t=c(72392),u=c(2109);function v(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function w(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){v(a,b,c[b])})}return a}function x(a,b){return b=null!=b?b:{},Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):(function(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);c.push.apply(c,d)}return c})(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))}),a}var y=function(a){return!!["/enterprise/demos/demo-1","/enterprise/demos/demo-2",].filter(function(b){return a.includes(b)}).length},z=function(){var a,b,c,v,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P;return z=(a={googleAccountConfigs:{client_id:(0,k.ZP)()||(0,k.a8)()?m.iOS.DEVELOPMENT:m.iOS.PRODUCTION,cancel_on_tap_outside:!1,context:"signin",prompt_parent_id:"g_id_onload"}}).googleAccountConfigs,E=(A="https://accounts.google.com/gsi/client",C=(B=(0,d.useState)(A?"loading":"idle"))[0],D=B[1],(0,d.useEffect)(function(){if(!A){D("idle");return}var a=document.querySelector('script[src="'.concat(A,'"]'));if(a)D(a.getAttribute("data-status")||"idle");else{(a=document.createElement("script")).src=A,a.async=!0,a.setAttribute("data-status","loading"),document.body.appendChild(a);var b=function(b){a&&a.setAttribute("data-status","load"===b.type?"ready":"error")};a.addEventListener("load",b),a.addEventListener("error",b)}var c=function(a){D("load"===a.type?"ready":"error")};return a.addEventListener("load",c),a.addEventListener("error",c),function(){a&&(a.removeEventListener("load",c),a.removeEventListener("error",c))}},[A]),C),F=(0,d.useContext)(h.wr),G=F.userInfoState,H=F.userInfoDispatch,I=F.loadUserInfo,J=G.loggedOut,K=G.loaded,L=null===(b=G.data)|| void 0===b?void 0:b.user_id,M=(0,j.useRouter)(),N=(0,e.ix)(function(a){return a.userConfig}),O=(0,e.TL)(),P=!y(M.pathname)&&((0,k.hN)()&&(0,l.gx)(null===(c=N.data)|| void 0===c?void 0:c.constants[m.zj2.ENABLE_SOCIAL_LOGIN_BETA])||(0,l.gx)(null===(v=N.data)|| void 0===v?void 0:v.constants[m.zj2.ENABLE_SOCIAL_LOGIN])),(0,d.useEffect)(function(){try{if(window.google&&"ready"===E){var a,b,c;null===(a=window.google)|| void 0===a||null===(b=a.accounts)|| void 0===b||null===(c=b.id)|| void 0===c||c.initialize(x(w({},z),{callback:function(a){return function(a,b,c,d,e){c(s.n.close());var h,j=null==window?void 0:null===(h=window.location)|| void 0===h?void 0:h.pathname;if(!a.credential)throw Error("Couldn't get id token from Google");var k=(null==j?void 0:j.includes("/login/holiday_campaign"))?"/unlimited":(null==j?void 0:j.includes("/login"))||(null==j?void 0:j.includes("signup"))?"/":null!=j?j:"/";(0,f.Z)({url:"/api/google-otl/return",type:"POST",data:x(w({token:a.credential,referral_site:(0,p.Ar)(),last_referral_site:(0,p.rT)(),referral_code:(0,q.I)()},(0,r.We)(),(0,r.bB)()),{impact_click_id:(0,u.iZ)()})}).then(function(a){var e=JSON.parse(a);if(302===e.status){b.push(e.location);return}!0===e.login_successful?(c((0,t.BL)()),document.documentElement.style.removeProperty("--loggedout-true"),document.documentElement.style.setProperty("--loggedout-false","none"),d(),g.Z.dispatch(i.s.load()),b.push(k),(0,o.qP)(e.operation===m.WHI.OPERATION.LOGIN?o.f2.LOGIN:o.f2.SIGNUP,e.operation===m.WHI.OPERATION.LOGIN?o.bt.LOGIN_SUCCEEDED:o.bt.SIGNUP_SUCCEEDED,"GOOGLE_OTL")):((0,o.qP)(e.operation===m.WHI.OPERATION.LOGIN?o.f2.LOGIN:o.f2.SIGNUP,e.operation===m.WHI.OPERATION.LOGIN?o.bt.LOGIN_FAILED:o.bt.SIGNUP_FAILED,"GOOGLE_OTL"),b.push("/login"))})}(a,M,O,I,H)}}))}}catch(d){(0,n.uX)(d)}},[E]),(0,d.useEffect)(function(){try{var a,b,c,d,e,f,g,h;if(L&&(null==window||null===(a=window.google)|| void 0===a||null===(b=a.accounts)|| void 0===b||null===(c=b.id)|| void 0===c||null===(d=c.cancel)|| void 0===d||d.call(c)),!J&&!K||L&&K)return;"ready"===E&&P&&(null===(e=window.google)|| void 0===e||null===(f=e.accounts)|| void 0===f||null===(g=f.id)|| void 0===g||null===(h=g.prompt)|| void 0===h||h.call(g))}catch(i){(0,n.uX)(i)}},[E,K,L,J,P]),(0,d.useEffect)(function(){var a,b,c,d;y(M.pathname)&&(null==window||null===(a=window.google)|| void 0===a||null===(b=a.accounts)|| void 0===b||null===(c=b.id)|| void 0===c||null===(d=c.cancel)|| void 0===d||d.call(c))},[M]),null}}}])
//# sourceMappingURL=82923.d67aadac2dc38457.js.map