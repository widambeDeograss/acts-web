"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[86695],{31228:function(a,b,c){c.d(b,{k:function(){return d}});var d={NONE:9009,SEVEN_DAY_MILESTONE:9010,ASSESSMENT_OR_FIRST_INCREMENT_TOUR:9011,FIRST_STREAK_INCREMENT_TOUR:9012,FIRST_BREAK_INTACT:9013}},86695:function(a,b,c){c.r(b),c.d(b,{MONTH_NAMES:function(){return C},STREAK_INCREMENT_TOAST_TYPES:function(){return z},STREAK_REVISION:function(){return y},STREAK_STATUS:function(){return x},STREAK_TOUR_TYPES:function(){return A},UserGamificationContext:function(){return E},WEEK_DAYS:function(){return B},default:function(){return F},userGamificationInitialState:function(){return D}});var d=c(20348),e=c(89703),f=c(27080),g=c(32565),h=c(67952);function i(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var j=function(a){var b=Intl.DateTimeFormat().resolvedOptions().timeZone;return(0,h.Z)(function(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){i(a,b,c[b])})}return a}({url:"/api/user/gamification/streak".concat(a?"":"?timezone=".concat(b)),type:a?"PUT":"GET"},a&&{data:{timezone:b,increment_streak:a}}))},k=c(32388),l=c(31228),m=c(30788),n=c(44678),o=c(20888),p=c(87268),q=c.n(p);function r(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function s(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function t(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){s(a,b,c[b])})}return a}function u(a,b){return b=null!=b?b:{},Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):(function(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);c.push.apply(c,d)}return c})(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))}),a}function v(a){return function(a){if(Array.isArray(a))return r(a)}(a)||function(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}(a)||w(a)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(a,b){if(a){if("string"==typeof a)return r(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return r(a,b)}}var x={ACTIVE:9e3,BROKEN:9001,FROZEN:9002,FIRST_BREAK_INTACT:9003},y={UNINITIALIZED:-1,FIRST_STREAK:0},z={NONE:0,NEXT_LESSON:1,CURRENT_LESSON:2},A={HEADER:0,INCREMENT:1,FIRST_BREAK_INTACT:2,USER_FEEDBACK:3},B=[{day:"Sunday",abbreviation:"Su"},{day:"Monday",abbreviation:"M"},{day:"Tuesday",abbreviation:"Tu"},{day:"Wednesday",abbreviation:"W"},{day:"Thursday",abbreviation:"Th"},{day:"Friday",abbreviation:"F"},{day:"Saturday",abbreviation:"Sa"},],C=["January","February","March","April","May","June","July","August","September","October","November","December",],D={data:{},error:"",loading:!1,loaded:!1},E=e.createContext({value:D,clearState:function(){},load:function(a,b){},incrementStreak:function(a){a.userInfo,a.userGamificationFeatureFlag},setStreakTour:function(){arguments.length>0&& void 0!==arguments[0]&&arguments[0]},setShowLessonToast:function(a){},showModal:function(a,b,c,d,e,f,g){},getModalType:function(a,b,c){return arguments.length>3&& void 0!==arguments[3]&&arguments[3],l.k.NONE},updateMonthlyStreaks:function(a){a.monthRange,a.monthData,a.endDate,a.clear},isStreakInfoOutdated:function(){return!1}}),F=function(a){var b,c,i,p=a.children,r=a.initialState,B=(c=e.useState(void 0===r?D:r),i=2,function(a){if(Array.isArray(a))return a}(c)||function(a,b){var c,d,e=null==a?null:"undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(null!=e){var f=[],g=!0,h=!1;try{for(e=e.call(a);!(g=(c=e.next()).done)&&(f.push(c.value),!b||f.length!==b);g=!0);}catch(i){h=!0,d=i}finally{try{g||null==e.return||e.return()}finally{if(h)throw d}}return f}}(c,i)||w(c,i)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),C=B[0],F=B[1],G=(0,n.TL)(),H=function(a,b){var c,d,e=arguments.length>2&& void 0!==arguments[2]?arguments[2]:0,f=arguments.length>3&& void 0!==arguments[3]&&arguments[3],h=arguments.length>4&& void 0!==arguments[4]&&arguments[4],i=arguments.length>5&& void 0!==arguments[5]&&arguments[5],j=arguments.length>6&& void 0!==arguments[6]&&arguments[6],m=arguments.length>7&& void 0!==arguments[7]?arguments[7]:function(){},n=arguments.length>8&& void 0!==arguments[8]?arguments[8]:0,o=arguments.length>9&& void 0!==arguments[9]?arguments[9]:"",p=(0,k.nOq)(n,null==b?void 0:null===(c=b.email)|| void 0===c?void 0:c.endsWith("educative.io"),(0,g.s)(b),!0),r=p?O(a.user_gamification.streak_revision,a.user_streak.count,a.user_gamification.viewed_increment_tour,f):l.k.NONE;!a.streak_incremented||r===l.k.NONE||i||f?m(!1):(P(m,r,h?"Continue to Next Lesson":"Continue to Next Task",j,p,o,a.user_streak.count),a.streak_incremented=!1,a.user_gamification.viewed_increment_tour=!0),F(function(b){var c,f,g,h,j,k,m,n,o,u,w,y;return{data:{userGamification:{streakRevision:a.user_gamification.streak_revision,viewedStreakTour:a.user_gamification.viewed_streak_tour,viewedIncrementTour:a.user_gamification.viewed_increment_tour,viewedFirstIntactTour:a.user_gamification.viewed_first_intact_tour,viewedUserFeedbackTour:a.user_gamification.viewed_user_feedback_tour,firstIntactUse:new Date(a.user_gamification.first_intact_use),enableStreaks:a.user_gamification.enable_streaks,userStreak:{count:a.user_streak.count||0,status:a.user_streak.status||x.BROKEN,monthsSpan:a.user_streak.months_span||[],lastUpdated:a.user_streak.last_updated,streakIncremented:a.streak_incremented,toastType:r===l.k.NONE&&p&&!i?e:z.NONE,monthlyData:{data:t({},null===(c=b.data)|| void 0===c?void 0:null===(f=c.userGamification)|| void 0===f?void 0:null===(g=f.userStreak)|| void 0===g?void 0:null===(h=g.monthlyData)|| void 0===h?void 0:h.data,a.streak_incremented?s({},q()(a.user_streak.last_updated).format("MM-DD-YYYY"),x.ACTIVE):{}),endDate:null===(j=b.data)|| void 0===j?void 0:null===(k=j.userGamification)|| void 0===k?void 0:null===(m=k.userStreak)|| void 0===m?void 0:null===(n=m.monthlyData)|| void 0===n?void 0:n.endDate,queriedMonths:new Set(v(Array.from(null!==(d=null===(o=b.data)|| void 0===o?void 0:null===(u=o.userGamification)|| void 0===u?void 0:null===(w=u.userStreak)|| void 0===w?void 0:null===(y=w.monthlyData)|| void 0===y?void 0:y.queriedMonths)&& void 0!==d?d:[])))}},longestStreak:a.user_gamification.longest_streak,lastFetchTime:new Date}},loading:!1,loaded:!0,error:""}})},I=function(a,b){var c,d,e,f,h,i;return null!=a&&!!a.user_id&&(!C.loaded||null!==(c=C.data.userGamification)&& void 0!==c&&!!c.enableStreaks)&&(0,k.nOq)(b,null==a?void 0:null===(d=a.email)|| void 0===d?void 0:d.endsWith("educative.io"),(0,g.s)(a))&&(!(null===(e=C.data.userGamification)|| void 0===e?void 0:null===(f=e.userStreak)|| void 0===f?void 0:f.lastUpdated)||new Date().setHours(1,0,0,0)>new Date(null===(h=C.data.userGamification)|| void 0===h?void 0:null===(i=h.userStreak)|| void 0===i?void 0:i.lastUpdated).setHours(1,0,0,0))},J=function(a,b,c,d){var e=arguments.length>4&& void 0!==arguments[4]&&arguments[4],g=arguments.length>5&& void 0!==arguments[5]&&arguments[5],h=arguments.length>6&& void 0!==arguments[6]&&arguments[6],i=arguments.length>7&& void 0!==arguments[7]&&arguments[7],k=arguments.length>8&& void 0!==arguments[8]?arguments[8]:function(){},l=arguments.length>9&& void 0!==arguments[9]?arguments[9]:"";I(a,c)?(F(function(a){return u(t({},a),{loading:!0,loaded:!1})}),j(b).then(function(b){return H(JSON.parse(b),a,d,e,g,h,i,k,c,l)}).catch(function(a){var b;return b=a,F({data:{},loading:!1,loaded:!1,error:(0,f.nU)(b)})})):k(!1)},K=function(){var a,b=arguments.length>0&& void 0!==arguments[0]?arguments[0]:A.HEADER;a=b,(0,h.Z)({url:"/api/user/gamification/tour?tour_type=".concat(a),type:"PUT"}),C.loaded&&F(function(a){return u(t({},a),{data:{userGamification:t({},a.data.userGamification,b===A.FIRST_BREAK_INTACT?{viewedFirstIntactTour:!0}:b===A.HEADER?{viewedStreakTour:1}:{viewedIncrementTour:!0})}})})},L=function(a){var c=a.monthRange,d=a.monthData,e=a.endDate,f=a.clear;return F(function(a){var g,h,i,j,k,l,m,n,o,p,q,r,s,w,x;return u(t({},a),{data:{userGamification:u(t({},null===(g=a.data)|| void 0===g?void 0:g.userGamification),{userStreak:u(t({},null===(h=a.data)|| void 0===h?void 0:null===(i=h.userGamification)|| void 0===i?void 0:i.userStreak),{monthlyData:t({},f?{data:{},endDate:"",queriedMonths:new Set}:{data:t({},null===(j=a.data)|| void 0===j?void 0:null===(k=j.userGamification)|| void 0===k?void 0:null===(l=k.userStreak)|| void 0===l?void 0:null===(m=l.monthlyData)|| void 0===m?void 0:m.data,d),endDate:e||(null===(n=a.data)|| void 0===n?void 0:null===(o=n.userGamification)|| void 0===o?void 0:null===(p=o.userStreak)|| void 0===p?void 0:null===(q=p.monthlyData)|| void 0===q?void 0:q.endDate),queriedMonths:new Set(v(Array.from(null!==(b=null===(r=a.data)|| void 0===r?void 0:null===(s=r.userGamification)|| void 0===s?void 0:null===(w=s.userStreak)|| void 0===w?void 0:null===(x=w.monthlyData)|| void 0===x?void 0:x.queriedMonths)&& void 0!==b?b:[])).concat([c,]))})})})}})})},M=function(a){C.loaded&&F(function(b){return u(t({},b),{data:{userGamification:u(t({},b.data.userGamification),{userStreak:u(t({},b.data.userGamification.userStreak),{toastType:null!=a?a:z.NONE,streakIncremented:!!a})})}})})},N=function(){return new Date().setHours(1,0,0,0)>C.data.userGamification.lastFetchTime.setHours(1,0,0,0)},O=function(a,b,c){var d,e,f,g=arguments.length>3&& void 0!==arguments[3]&&arguments[3];return c?7===(d=b)?l.k.SEVEN_DAY_MILESTONE:g?l.k.ASSESSMENT_OR_FIRST_INCREMENT_TOUR:l.k.NONE:(e=a,f=b,e===y.FIRST_STREAK&&1===f)?l.k.FIRST_STREAK_INCREMENT_TOUR:l.k.ASSESSMENT_OR_FIRST_INCREMENT_TOUR},P=function(a,b,c,d,e,f,g){if(e){var h,i,j;G(o.n.show(m.Oy,{onConfirm:function(){a(!0)},streakCount:g||(null===(h=C.data)|| void 0===h?void 0:null===(i=h.userGamification)|| void 0===i?void 0:null===(j=i.userStreak)|| void 0===j?void 0:j.count),statusType:b,ctaText:c,closeable:d,workType:f})),K(A.INCREMENT),M(z.NONE)}};return(0,d.jsx)(E.Provider,{value:{value:C,clearState:function(){F(t({},D))},load:function(a,b){return J(a,!1,b)},incrementStreak:function(a){var b=a.userInfo,c=a.userGamificationFeatureFlag,d=a.toastType,e=void 0===d?z.NONE:d,f=a.isAssessment,g=a.isCourse,h=a.isWorkCompleted,i=a.isLastTask,j=a.callBack,k=a.workType;return J(b,!0,c,e,void 0!==f&&f,void 0!==g&&g,void 0!==h&&h,void 0!==i&&i,j,void 0===k?"":k)},setStreakTour:K,setShowLessonToast:M,showModal:P,getModalType:O,updateMonthlyStreaks:L,isStreakInfoOutdated:N},children:p})}}}])
//# sourceMappingURL=86695.2adac0bce7097d1c.js.map